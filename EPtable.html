<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta name="x-poe-datastore-behavior" content="local_only">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>互動週期表 - 輕量資訊版</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&amp;family=JetBrains+Mono:wght@400;700&amp;display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a25;
            --text-primary: #e8e8ec;
            --text-secondary: #8888a0;
            --accent: #00d4aa;
            --accent-glow: rgba(0, 212, 170, 0.3);
            --animation-duration: 1s;

            /* Element category colors */
            --alkali: #ff6b6b;
            --alkaline: #ffa94d;
            --transition: #74c0fc;
            --post-transition: #69db7c;
            --metalloid: #9775fa;
            --nonmetal: #ffd43b;
            --halogen: #f06595;
            --noble: #a9e34b;
            --lanthanide: #4dabf7;
            --actinide: #e599f7;
            --unknown: #868e96;
        }

        .dark {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --text-primary: #e8e8ec;
            --text-secondary: #8888a0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            touch-action: none;
        }

        /* --- Header Area --- */
        .app-header {
            background: var(--bg-secondary);
            padding: 8px 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            z-index: 10;
            flex-shrink: 0;
        }

        .header-top-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
            gap: 10px;
        }

        .brand {
            display: flex;
            align-items: baseline;
            gap: 8px;
            min-width: 0;
        }

        h1 {
            font-size: 1.3rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent), #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
            white-space: nowrap;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 0.75rem;
            display: inline;
        }

        .view-controls {
            display: flex;
            gap: 4px;
            flex-shrink: 0;
        }

        .view-btn {
            padding: 5px 10px;
            font-size: 12px;
            font-family: 'Noto Sans TC', sans-serif;
            font-weight: 600;
            border: 1px solid var(--accent);
            background: transparent;
            color: var(--accent);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .view-btn:hover, .view-btn.active {
            background: var(--accent);
            color: var(--bg-primary);
        }

        .header-bottom-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
        }

        .property-bar {
            display: flex;
            align-items: center;
            gap: 6px;
            background: var(--bg-tertiary);
            padding: 4px 8px;
            border-radius: 8px;
            overflow-x: auto;
            white-space: nowrap;
            max-width: 100%;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }
        
        .property-bar::-webkit-scrollbar { display: none; }

        .property-label {
            font-size: 12px;
            color: var(--text-secondary);
            flex-shrink: 0;
        }

        .property-select {
            background: var(--bg-primary);
            color: var(--text-primary);
            border: 1px solid var(--text-secondary);
            padding: 3px 6px;
            border-radius: 4px;
            font-size: 12px;
            outline: none;
            font-family: 'Noto Sans TC', sans-serif;
            cursor: pointer;
            min-width: 110px;
        }

        .property-select:hover {
            border-color: var(--accent);
        }

        .action-bar {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
        }

        .zoom-group {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .zoom-btn {
            width: 24px;
            height: 24px;
            font-size: 11px;
            border: 1px solid var(--text-secondary);
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .zoom-btn:hover { color: var(--accent); border-color: var(--accent); }

        .zoom-display {
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            color: var(--accent);
            width: 32px;
            text-align: center;
        }

        .speed-group {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .speed-slider {
            width: 50px;
            height: 4px;
            background: var(--bg-tertiary);
            border-radius: 2px;
            outline: none;
            cursor: pointer;
            -webkit-appearance: none;
        }
        
        .speed-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            background: var(--accent);
            border-radius: 50%;
            cursor: pointer;
        }

        .speed-display {
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            color: var(--accent);
            width: 20px;
            text-align: right;
        }

        /* --- Main Viewport --- */
        .table-container {
            flex: 1;
            position: relative;
            overflow: hidden;
            background: var(--bg-primary);
            cursor: grab;
            user-select: none;
            touch-action: none;
        }

        .table-container.grabbing {
            cursor: grabbing;
        }

        .periodic-table {
            position: absolute;
            top: 0;
            left: 0;
            transform-origin: 0 0;
            will-change: transform;
        }

        .element {
            position: absolute;
            width: 48px;
            height: 56px;
            background: var(--bg-primary);
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: left var(--animation-duration) cubic-bezier(0.4, 0, 0.2, 1),
                        top var(--animation-duration) cubic-bezier(0.4, 0, 0.2, 1),
                        transform 0.2s ease,
                        box-shadow 0.2s ease,
                        background-color 0.4s ease,
                        border-radius 0.4s ease;
            border: 1px solid rgba(255,255,255,0.1);
            overflow: hidden;
            transform: scale(var(--el-scale, 1));
        }

        /* Category Color Strip */
        .element::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--category-color);
            transition: opacity 0.3s ease;
            opacity: 1;
            z-index: 2;
        }

        .element.bar-mode::before { opacity: 0.3; }

        @media (hover: hover) {
            .element:hover {
                z-index: 100;
                box-shadow: 0 10px 40px rgba(0,0,0,0.5), 0 0 20px var(--category-color);
                transform: scale(calc(var(--el-scale, 1) * 1.25));
            }
        }

        /* --- Mode: Radius (Sphere) --- */
        .element.radius-mode {
            height: 48px;
            margin-top: 4px;
            border-radius: 50%;
            box-shadow: inset -3px -3px 6px rgba(0,0,0,0.6), inset 3px 3px 6px rgba(255,255,255,0.3);
            border: none;
        }
        .element.radius-mode::before { display: none; }
        .element.radius-mode:hover {
            box-shadow: inset -3px -3px 6px rgba(0,0,0,0.6), inset 3px 3px 6px rgba(255,255,255,0.3), 0 0 20px var(--category-color);
        }
        .element.radius-mode .number, 
        .element.radius-mode .name, 
        .element.radius-mode .mass,
        .element.radius-mode .property-bar { display: none; }

        .element.radius-mode .symbol {
            top: 50%; left: 50%; transform: translate(-50%, -70%);
            font-size: 14px; text-shadow: 0 1px 2px rgba(0,0,0,0.8);
        }
        .element.radius-mode .property-value {
            bottom: 22%; font-size: 9px; text-shadow: 0 1px 2px rgba(0,0,0,0.8);
        }

        /* --- Mode: Bar Chart --- */
        .element.bar-mode {
            background-color: rgba(26, 26, 37, 0.8) !important;
        }
        
        .element.bar-mode .property-bar {
            opacity: 1;
        }

        .element .property-bar {
            position: absolute;
            bottom: 0; left: 0; right: 0;
            height: 0; 
            background: linear-gradient(to top, var(--prop-color), transparent);
            transition: height 0.6s cubic-bezier(0.22, 1, 0.36, 1);
            pointer-events: none;
            opacity: 0.7;
            z-index: 0;
        }

        /* Standard Text Positioning */
        .element .number {
            position: absolute; top: 2px; left: 3px;
            font-size: 8px; color: var(--text-secondary);
            font-family: 'JetBrains Mono', monospace; z-index: 1;
        }
        .element .symbol {
            position: absolute; top: 3px; right: 3px;
            font-size: 9px; font-weight: 600; color: var(--text-secondary);
            font-family: 'JetBrains Mono', monospace; z-index: 1;
        }
        .element .name {
            font-size: 16px; font-weight: 700; color: var(--text-primary);
            text-align: center; margin-top: 4px; z-index: 1;
        }
        .element .mass {
            position: absolute; bottom: 3px; left: 0; right: 0;
            font-size: 7px; color: var(--text-secondary); opacity: 0.8;
            font-family: 'JetBrains Mono', monospace; text-align: center; z-index: 1;
        }
        .element.property-mode .mass { opacity: 0; }

        .element .property-value {
            position: absolute; bottom: 2px; left: 0; right: 0;
            font-size: 8px; font-weight: 700; color: transparent;
            font-family: 'JetBrains Mono', monospace; text-align: center; z-index: 2;
        }
        
        .element.property-mode .property-value {
            color: var(--text-primary); text-shadow: 0 0 4px rgba(0,0,0,1);
        }

        .element.light-bg .number, .element.light-bg .symbol, .element.light-bg .name, .element.light-bg .mass, .element.light-bg .property-value {
            color: #1a1a2e; text-shadow: none;
        }

        /* --- Footer Legend --- */
        .app-footer {
            background: var(--bg-secondary);
            padding: 8px 15px;
            border-top: 1px solid var(--bg-tertiary);
            flex-shrink: 0;
            z-index: 10;
        }

        .legend {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 4px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 10px;
            color: var(--text-secondary);
        }

        .legend-color { width: 8px; height: 8px; border-radius: 2px; }

        .view-info {
            text-align: center; font-size: 10px; color: var(--text-secondary); margin-top: 2px;
        }

        /* Color Scale */
        .color-scale {
            display: none; align-items: center; gap: 6px;
            margin-left: 10px; padding-left: 10px; border-left: 1px solid var(--text-secondary);
        }
        .color-scale.visible { display: flex; }
        .scale-bar {
            width: 60px; height: 6px; border-radius: 3px;
            background: linear-gradient(to right, #1a1a2e, #ffd93d);
        }
        .scale-info { display: flex; flex-direction: column; gap: 0px; }
        .scale-title { font-size: 10px; color: var(--accent); }
        .scale-labels { display: flex; justify-content: space-between; font-size: 8px; color: var(--text-secondary); }

        /* Tooltip Compact Style */
        .tooltip {
            position: fixed;
            background: var(--bg-secondary);
            border: 1px solid var(--accent);
            border-radius: 8px;
            padding: 10px; /* Reduced padding */
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            max-width: 260px;
            left: 50%; top: 50%; transform: translate(-50%, -50%);
            display: flex;
            flex-direction: column;
            gap: 5px; /* Tighter gap */
        }
        .tooltip.visible { opacity: 1; pointer-events: auto; }
        
        .tooltip-header {
            display: flex;
            align-items: baseline;
            gap: 6px;
            margin-bottom: 2px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 4px;
        }

        .tooltip h3 { 
            font-size: 1.1rem; 
            margin: 0;
            color: var(--accent); 
        }
        
        .tooltip .atomic-number {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .tooltip .category-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-left: auto;
        }

        .tooltip .prop-highlight { color: var(--accent); font-weight: 600; }
        
        .atom-container {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 5px;
        }
        
        /* Compact SVG style */
        .atom-svg {
            width: 120px;
            height: 120px;
        }

        .atom-svg text {
            font-family: 'JetBrains Mono', monospace;
            fill: var(--text-primary);
            font-weight: bold;
        }
        
        /* Compact Properties Grid */
        .props-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2px 8px;
            font-size: 11px;
        }
        
        .prop-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .prop-label {
            color: var(--text-secondary);
        }
        
        .prop-val {
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
        }
        
        .prop-focus {
            grid-column: 1 / -1;
            background: rgba(0, 212, 170, 0.1);
            padding: 2px 4px;
            border-radius: 4px;
            margin-bottom: 4px;
            display: flex;
            justify-content: space-between;
        }
        
        .prop-focus .prop-val {
            color: var(--accent);
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .app-header { padding: 8px 12px; }
            h1 { font-size: 1.2rem; }
            .subtitle { display: none; }
            .header-top-row { flex-wrap: wrap; gap: 5px; }
            .header-bottom-row { gap: 8px; }
            .view-btn { padding: 5px 8px; font-size: 11px; }
            .property-bar { flex: 1 1 100%; order: 2; }
            .action-bar { flex: 1 1 auto; justify-content: space-between; order: 1; width: 100%; }
            .tooltip { width: 85%; max-width: 300px; }
        }
        
        @media (min-width: 769px) {
            .tooltip { transform: none; left: auto; top: auto; }
        }
    </style>
</head>
<body>
    <header class="app-header">
        <div class="header-top-row">
            <div class="brand">
                <h1>互動週期表</h1>
                <span class="subtitle">無限畫布</span>
            </div>
            <div class="view-controls">
                <button class="view-btn" data-view="linear">序列</button>
                <button class="view-btn active" data-view="standard">標準</button>
                <button class="view-btn" data-view="extended">寬版</button>
            </div>
        </div>

        <div class="header-bottom-row">
            <div class="action-bar">
                <div class="zoom-group">
                    <button class="zoom-btn" id="zoomOut"><i class="fas fa-minus"></i></button>
                    <div class="zoom-display" id="zoomDisplay">100%</div>
                    <button class="zoom-btn" id="zoomIn"><i class="fas fa-plus"></i></button>
                    <button class="zoom-btn" id="zoomReset"><i class="fas fa-compress"></i></button>
                </div>
                
                <div class="speed-group">
                    <span class="property-label"><i class="fas fa-clock"></i></span>
                    <input type="range" class="speed-slider" id="speedSlider" min="0" max="5" step="1" value="2">
                    <span class="speed-display" id="speedDisplay">1s</span>
                </div>
            </div>

            <div class="property-bar">
                <span class="property-label"><i class="fas fa-layer-group"></i></span>
                <select id="propertySelect" class="property-select">
                    <option value="none">顯示性質：無</option>
                    <option value="ionization">第一游離能</option>
                    <option value="electronegativity">電負度</option>
                    <option value="density">密度</option>
                    <option value="radius">原子半徑</option>
                    <option value="specific_heat">比熱 (J/g·K)</option>
                    <option value="thermal_conductivity">導熱率 (W/m·K)</option>
                    <option value="electrical_conductivity">導電率 (MS/m)</option>
                </select>
                
                <div class="color-scale" id="colorScale">
                    <div class="scale-info">
                        <span class="scale-title" id="scaleTitle">Data</span>
                        <div class="scale-bar"></div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="table-container" id="tableContainer">
        <div class="periodic-table" id="periodicTable"></div>
    </div>

    <footer class="app-footer">
        <div class="legend" id="categoryLegend">
            <div class="legend-item"><div class="legend-color" style="background: var(--alkali)"></div>鹼金屬</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--alkaline)"></div>鹼土</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--transition)"></div>過渡</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--post-transition)"></div>後過渡</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--metalloid)"></div>類金屬</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--nonmetal)"></div>非金屬</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--halogen)"></div>鹵素</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--noble)"></div>稀有</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--lanthanide)"></div>鑭系</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--actinide)"></div>錒系</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--unknown)"></div>未知</div>
        </div>
        <div class="view-info" id="viewInfo">
            目前視圖：標準週期表
        </div>
    </footer>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // Data and Configuration
        const categoryColors = {
            'alkali': '#ff6b6b',
            'alkaline': '#ffa94d',
            'transition': '#74c0fc',
            'post-transition': '#69db7c',
            'metalloid': '#9775fa',
            'nonmetal': '#ffd43b',
            'halogen': '#f06595',
            'noble': '#a9e34b',
            'lanthanide': '#4dabf7',
            'actinide': '#e599f7',
            'unknown': '#868e96'
        };

        const elements = [
            { z: 1, symbol: "H", name: "氫", category: "nonmetal", shells: [1], mass: "1.008", ionization: 1312, electronegativity: 2.20, density: 0.00009, radius: 53, specific_heat: 14.304, thermal_conductivity: 0.1805, electrical_conductivity: null },
            { z: 2, symbol: "He", name: "氦", category: "noble", shells: [2], mass: "4.003", ionization: 2372, electronegativity: null, density: 0.00018, radius: 31, specific_heat: 5.193, thermal_conductivity: 0.1513, electrical_conductivity: null },
            { z: 3, symbol: "Li", name: "鋰", category: "alkali", shells: [2, 1], mass: "6.94", ionization: 520, electronegativity: 0.98, density: 0.534, radius: 167, specific_heat: 3.582, thermal_conductivity: 85, electrical_conductivity: 10.8 },
            { z: 4, symbol: "Be", name: "鈹", category: "alkaline", shells: [2, 2], mass: "9.012", ionization: 900, electronegativity: 1.57, density: 1.85, radius: 112, specific_heat: 1.825, thermal_conductivity: 190, electrical_conductivity: 31.3 },
            { z: 5, symbol: "B", name: "硼", category: "metalloid", shells: [2, 3], mass: "10.81", ionization: 801, electronegativity: 2.04, density: 2.34, radius: 87, specific_heat: 1.026, thermal_conductivity: 27, electrical_conductivity: 1e-12 },
            { z: 6, symbol: "C", name: "碳", category: "nonmetal", shells: [2, 4], mass: "12.01", ionization: 1086, electronegativity: 2.55, density: 2.267, radius: 67, specific_heat: 0.709, thermal_conductivity: 140, electrical_conductivity: 0.061 },
            { z: 7, symbol: "N", name: "氮", category: "nonmetal", shells: [2, 5], mass: "14.01", ionization: 1402, electronegativity: 3.04, density: 0.00125, radius: 56, specific_heat: 1.04, thermal_conductivity: 0.0258, electrical_conductivity: null },
            { z: 8, symbol: "O", name: "氧", category: "nonmetal", shells: [2, 6], mass: "16.00", ionization: 1314, electronegativity: 3.44, density: 0.00143, radius: 48, specific_heat: 0.918, thermal_conductivity: 0.0265, electrical_conductivity: null },
            { z: 9, symbol: "F", name: "氟", category: "halogen", shells: [2, 7], mass: "19.00", ionization: 1681, electronegativity: 3.98, density: 0.0017, radius: 42, specific_heat: 0.824, thermal_conductivity: 0.0277, electrical_conductivity: null },
            { z: 10, symbol: "Ne", name: "氖", category: "noble", shells: [2, 8], mass: "20.18", ionization: 2081, electronegativity: null, density: 0.0009, radius: 38, specific_heat: 1.03, thermal_conductivity: 0.0491, electrical_conductivity: null },
            { z: 11, symbol: "Na", name: "鈉", category: "alkali", shells: [2, 8, 1], mass: "22.99", ionization: 496, electronegativity: 0.93, density: 0.971, radius: 190, specific_heat: 1.228, thermal_conductivity: 140, electrical_conductivity: 21 },
            { z: 12, symbol: "Mg", name: "鎂", category: "alkaline", shells: [2, 8, 2], mass: "24.31", ionization: 738, electronegativity: 1.31, density: 1.738, radius: 145, specific_heat: 1.023, thermal_conductivity: 156, electrical_conductivity: 22.6 },
            { z: 13, symbol: "Al", name: "鋁", category: "post-transition", shells: [2, 8, 3], mass: "26.98", ionization: 578, electronegativity: 1.61, density: 2.698, radius: 118, specific_heat: 0.897, thermal_conductivity: 237, electrical_conductivity: 37.7 },
            { z: 14, symbol: "Si", name: "矽", category: "metalloid", shells: [2, 8, 4], mass: "28.09", ionization: 786, electronegativity: 1.90, density: 2.3296, radius: 111, specific_heat: 0.705, thermal_conductivity: 148, electrical_conductivity: 2.52e-10 },
            { z: 15, symbol: "P", name: "磷", category: "nonmetal", shells: [2, 8, 5], mass: "30.97", ionization: 1012, electronegativity: 2.19, density: 1.82, radius: 98, specific_heat: 0.769, thermal_conductivity: 0.236, electrical_conductivity: 1e-17 },
            { z: 16, symbol: "S", name: "硫", category: "nonmetal", shells: [2, 8, 6], mass: "32.06", ionization: 1000, electronegativity: 2.58, density: 2.067, radius: 88, specific_heat: 0.71, thermal_conductivity: 0.205, electrical_conductivity: 5e-22 },
            { z: 17, symbol: "Cl", name: "氯", category: "halogen", shells: [2, 8, 7], mass: "35.45", ionization: 1251, electronegativity: 3.16, density: 0.00321, radius: 79, specific_heat: 0.479, thermal_conductivity: 0.0089, electrical_conductivity: null },
            { z: 18, symbol: "Ar", name: "氬", category: "noble", shells: [2, 8, 8], mass: "39.95", ionization: 1521, electronegativity: null, density: 0.0018, radius: 71, specific_heat: 0.52, thermal_conductivity: 0.0177, electrical_conductivity: null },
            { z: 19, symbol: "K", name: "鉀", category: "alkali", shells: [2, 8, 8, 1], mass: "39.10", ionization: 419, electronegativity: 0.82, density: 0.862, radius: 243, specific_heat: 0.757, thermal_conductivity: 102.5, electrical_conductivity: 13.9 },
            { z: 20, symbol: "Ca", name: "鈣", category: "alkaline", shells: [2, 8, 8, 2], mass: "40.08", ionization: 590, electronegativity: 1.00, density: 1.54, radius: 194, specific_heat: 0.647, thermal_conductivity: 201, electrical_conductivity: 29.8 },
            { z: 21, symbol: "Sc", name: "鈧", category: "transition", shells: [2, 8, 9, 2], mass: "44.96", ionization: 633, electronegativity: 1.36, density: 2.989, radius: 184, specific_heat: 0.568, thermal_conductivity: 15.8, electrical_conductivity: 1.77 },
            { z: 22, symbol: "Ti", name: "鈦", category: "transition", shells: [2, 8, 10, 2], mass: "47.87", ionization: 659, electronegativity: 1.54, density: 4.54, radius: 176, specific_heat: 0.523, thermal_conductivity: 21.9, electrical_conductivity: 2.38 },
            { z: 23, symbol: "V", name: "釩", category: "transition", shells: [2, 8, 11, 2], mass: "50.94", ionization: 651, electronegativity: 1.63, density: 6.11, radius: 171, specific_heat: 0.489, thermal_conductivity: 30.7, electrical_conductivity: 5 },
            { z: 24, symbol: "Cr", name: "鉻", category: "transition", shells: [2, 8, 13, 1], mass: "52.00", ionization: 653, electronegativity: 1.66, density: 7.15, radius: 166, specific_heat: 0.449, thermal_conductivity: 93.9, electrical_conductivity: 7.74 },
            { z: 25, symbol: "Mn", name: "錳", category: "transition", shells: [2, 8, 13, 2], mass: "54.94", ionization: 717, electronegativity: 1.55, density: 7.44, radius: 161, specific_heat: 0.479, thermal_conductivity: 7.81, electrical_conductivity: 0.695 },
            { z: 26, symbol: "Fe", name: "鐵", category: "transition", shells: [2, 8, 14, 2], mass: "55.85", ionization: 762, electronegativity: 1.83, density: 7.874, radius: 156, specific_heat: 0.449, thermal_conductivity: 80.4, electrical_conductivity: 9.93 },
            { z: 27, symbol: "Co", name: "鈷", category: "transition", shells: [2, 8, 15, 2], mass: "58.93", ionization: 760, electronegativity: 1.88, density: 8.86, radius: 152, specific_heat: 0.421, thermal_conductivity: 100, electrical_conductivity: 17.2 },
            { z: 28, symbol: "Ni", name: "鎳", category: "transition", shells: [2, 8, 16, 2], mass: "58.69", ionization: 737, electronegativity: 1.91, density: 8.912, radius: 149, specific_heat: 0.444, thermal_conductivity: 90.9, electrical_conductivity: 14.3 },
            { z: 29, symbol: "Cu", name: "銅", category: "transition", shells: [2, 8, 18, 1], mass: "63.55", ionization: 745, electronegativity: 1.90, density: 8.96, radius: 145, specific_heat: 0.385, thermal_conductivity: 401, electrical_conductivity: 59.6 },
            { z: 30, symbol: "Zn", name: "鋅", category: "transition", shells: [2, 8, 18, 2], mass: "65.38", ionization: 906, electronegativity: 1.65, density: 7.134, radius: 142, specific_heat: 0.388, thermal_conductivity: 116, electrical_conductivity: 16.6 },
            { z: 31, symbol: "Ga", name: "鎵", category: "post-transition", shells: [2, 8, 18, 3], mass: "69.72", ionization: 579, electronegativity: 1.81, density: 5.907, radius: 136, specific_heat: 0.371, thermal_conductivity: 40.6, electrical_conductivity: 6.78 },
            { z: 32, symbol: "Ge", name: "鍺", category: "metalloid", shells: [2, 8, 18, 4], mass: "72.63", ionization: 762, electronegativity: 2.01, density: 5.323, radius: 125, specific_heat: 0.32, thermal_conductivity: 60.2, electrical_conductivity: 2.17 },
            { z: 33, symbol: "As", name: "砷", category: "metalloid", shells: [2, 8, 18, 5], mass: "74.92", ionization: 947, electronegativity: 2.18, density: 5.776, radius: 114, specific_heat: 0.329, thermal_conductivity: 50.2, electrical_conductivity: 3.45 },
            { z: 34, symbol: "Se", name: "硒", category: "nonmetal", shells: [2, 8, 18, 6], mass: "78.96", ionization: 941, electronegativity: 2.55, density: 4.809, radius: 103, specific_heat: 0.321, thermal_conductivity: 0.519, electrical_conductivity: 1e-10 },
            { z: 35, symbol: "Br", name: "溴", category: "halogen", shells: [2, 8, 18, 7], mass: "79.90", ionization: 1140, electronegativity: 2.96, density: 3.122, radius: 94, specific_heat: 0.474, thermal_conductivity: 0.122, electrical_conductivity: 1e-16 },
            { z: 36, symbol: "Kr", name: "氪", category: "noble", shells: [2, 8, 18, 8], mass: "83.80", ionization: 1351, electronegativity: 3.00, density: 0.00375, radius: 88, specific_heat: 0.248, thermal_conductivity: 0.0094, electrical_conductivity: null },
            { z: 37, symbol: "Rb", name: "銣", category: "alkali", shells: [2, 8, 18, 8, 1], mass: "85.47", ionization: 403, electronegativity: 0.82, density: 1.532, radius: 265, specific_heat: 0.363, thermal_conductivity: 58.2, electrical_conductivity: 7.79 },
            { z: 38, symbol: "Sr", name: "鍶", category: "alkaline", shells: [2, 8, 18, 8, 2], mass: "87.62", ionization: 550, electronegativity: 0.95, density: 2.64, radius: 219, specific_heat: 0.301, thermal_conductivity: 35.4, electrical_conductivity: 7.62 },
            { z: 39, symbol: "Y", name: "釔", category: "transition", shells: [2, 8, 18, 9, 2], mass: "88.91", ionization: 600, electronegativity: 1.22, density: 4.469, radius: 212, specific_heat: 0.298, thermal_conductivity: 17.2, electrical_conductivity: 1.66 },
            { z: 40, symbol: "Zr", name: "鋯", category: "transition", shells: [2, 8, 18, 10, 2], mass: "91.22", ionization: 640, electronegativity: 1.33, density: 6.506, radius: 206, specific_heat: 0.278, thermal_conductivity: 22.6, electrical_conductivity: 2.36 },
            { z: 41, symbol: "Nb", name: "鈮", category: "transition", shells: [2, 8, 18, 12, 1], mass: "92.91", ionization: 652, electronegativity: 1.6, density: 8.57, radius: 198, specific_heat: 0.265, thermal_conductivity: 53.7, electrical_conductivity: 6.93 },
            { z: 42, symbol: "Mo", name: "鉬", category: "transition", shells: [2, 8, 18, 13, 1], mass: "95.95", ionization: 684, electronegativity: 2.16, density: 10.22, radius: 190, specific_heat: 0.251, thermal_conductivity: 138, electrical_conductivity: 17.4 },
            { z: 43, symbol: "Tc", name: "鎝", category: "transition", shells: [2, 8, 18, 13, 2], mass: "(98)", ionization: 702, electronegativity: 1.9, density: 11.5, radius: 183, specific_heat: null, thermal_conductivity: 50.6, electrical_conductivity: 6.7 },
            { z: 44, symbol: "Ru", name: "釕", category: "transition", shells: [2, 8, 18, 15, 1], mass: "101.1", ionization: 710, electronegativity: 2.2, density: 12.37, radius: 178, specific_heat: 0.238, thermal_conductivity: 117, electrical_conductivity: 13.7 },
            { z: 45, symbol: "Rh", name: "銠", category: "transition", shells: [2, 8, 18, 16, 1], mass: "102.9", ionization: 720, electronegativity: 2.28, density: 12.41, radius: 173, specific_heat: 0.243, thermal_conductivity: 150, electrical_conductivity: 21.1 },
            { z: 46, symbol: "Pd", name: "鈀", category: "transition", shells: [2, 8, 18, 18], mass: "106.4", ionization: 804, electronegativity: 2.20, density: 12.02, radius: 169, specific_heat: 0.244, thermal_conductivity: 71.8, electrical_conductivity: 9.5 },
            { z: 47, symbol: "Ag", name: "銀", category: "transition", shells: [2, 8, 18, 18, 1], mass: "107.9", ionization: 731, electronegativity: 1.93, density: 10.501, radius: 165, specific_heat: 0.235, thermal_conductivity: 429, electrical_conductivity: 63 },
            { z: 48, symbol: "Cd", name: "鎘", category: "transition", shells: [2, 8, 18, 18, 2], mass: "112.4", ionization: 868, electronegativity: 1.69, density: 8.69, radius: 161, specific_heat: 0.232, thermal_conductivity: 96.6, electrical_conductivity: 13.8 },
            { z: 49, symbol: "In", name: "銦", category: "post-transition", shells: [2, 8, 18, 18, 3], mass: "114.8", ionization: 558, electronegativity: 1.78, density: 7.31, radius: 156, specific_heat: 0.233, thermal_conductivity: 81.8, electrical_conductivity: 11.6 },
            { z: 50, symbol: "Sn", name: "錫", category: "post-transition", shells: [2, 8, 18, 18, 4], mass: "118.7", ionization: 709, electronegativity: 1.96, density: 7.287, radius: 145, specific_heat: 0.228, thermal_conductivity: 66.8, electrical_conductivity: 9.17 },
            { z: 51, symbol: "Sb", name: "銻", category: "metalloid", shells: [2, 8, 18, 18, 5], mass: "121.8", ionization: 834, electronegativity: 2.05, density: 6.685, radius: 133, specific_heat: 0.207, thermal_conductivity: 24.4, electrical_conductivity: 2.88 },
            { z: 52, symbol: "Te", name: "碲", category: "metalloid", shells: [2, 8, 18, 18, 6], mass: "127.6", ionization: 869, electronegativity: 2.1, density: 6.232, radius: 123, specific_heat: 0.202, thermal_conductivity: 1.97, electrical_conductivity: 0.0002 },
            { z: 53, symbol: "I", name: "碘", category: "halogen", shells: [2, 8, 18, 18, 7], mass: "126.9", ionization: 1008, electronegativity: 2.66, density: 4.93, radius: 115, specific_heat: 0.214, thermal_conductivity: 0.449, electrical_conductivity: 8e-14 },
            { z: 54, symbol: "Xe", name: "氙", category: "noble", shells: [2, 8, 18, 18, 8], mass: "131.3", ionization: 1170, electronegativity: 2.60, density: 0.0059, radius: 108, specific_heat: 0.158, thermal_conductivity: 0.0057, electrical_conductivity: null },
            { z: 55, symbol: "Cs", name: "銫", category: "alkali", shells: [2, 8, 18, 18, 8, 1], mass: "132.9", ionization: 376, electronegativity: 0.79, density: 1.873, radius: 298, specific_heat: 0.242, thermal_conductivity: 35.9, electrical_conductivity: 4.89 },
            { z: 56, symbol: "Ba", name: "鋇", category: "alkaline", shells: [2, 8, 18, 18, 8, 2], mass: "137.3", ionization: 503, electronegativity: 0.89, density: 3.594, radius: 253, specific_heat: 0.204, thermal_conductivity: 18.4, electrical_conductivity: 2.8 },
            { z: 57, symbol: "La", name: "鑭", category: "lanthanide", shells: [2, 8, 18, 18, 9, 2], mass: "138.9", ionization: 538, electronegativity: 1.1, density: 6.145, radius: 195, specific_heat: 0.195, thermal_conductivity: 13.4, electrical_conductivity: 1.26 },
            { z: 58, symbol: "Ce", name: "鈰", category: "lanthanide", shells: [2, 8, 18, 19, 9, 2], mass: "140.1", ionization: 534, electronegativity: 1.12, density: 6.77, radius: 185, specific_heat: 0.192, thermal_conductivity: 11.3, electrical_conductivity: 1.15 },
            { z: 59, symbol: "Pr", name: "鐠", category: "lanthanide", shells: [2, 8, 18, 21, 8, 2], mass: "140.9", ionization: 527, electronegativity: 1.13, density: 6.773, radius: 247, specific_heat: 0.193, thermal_conductivity: 12.5, electrical_conductivity: 1.48 },
            { z: 60, symbol: "Nd", name: "釹", category: "lanthanide", shells: [2, 8, 18, 22, 8, 2], mass: "144.2", ionization: 533, electronegativity: 1.14, density: 7.007, radius: 206, specific_heat: 0.19, thermal_conductivity: 16.5, electrical_conductivity: 1.57 },
            { z: 61, symbol: "Pm", name: "鉕", category: "lanthanide", shells: [2, 8, 18, 23, 8, 2], mass: "(145)", ionization: 540, electronegativity: 1.13, density: 7.26, radius: 205, specific_heat: null, thermal_conductivity: 17.9, electrical_conductivity: 1.3 },
            { z: 62, symbol: "Sm", name: "釤", category: "lanthanide", shells: [2, 8, 18, 24, 8, 2], mass: "150.4", ionization: 545, electronegativity: 1.17, density: 7.52, radius: 238, specific_heat: 0.197, thermal_conductivity: 13.3, electrical_conductivity: 0.956 },
            { z: 63, symbol: "Eu", name: "銪", category: "lanthanide", shells: [2, 8, 18, 25, 8, 2], mass: "152.0", ionization: 547, electronegativity: 1.2, density: 5.243, radius: 231, specific_heat: 0.182, thermal_conductivity: 13.9, electrical_conductivity: 1.12 },
            { z: 64, symbol: "Gd", name: "釓", category: "lanthanide", shells: [2, 8, 18, 25, 9, 2], mass: "157.3", ionization: 593, electronegativity: 1.2, density: 7.895, radius: 233, specific_heat: 0.236, thermal_conductivity: 10.6, electrical_conductivity: 0.736 },
            { z: 65, symbol: "Tb", name: "鋱", category: "lanthanide", shells: [2, 8, 18, 27, 8, 2], mass: "158.9", ionization: 566, electronegativity: 1.1, density: 8.229, radius: 225, specific_heat: 0.182, thermal_conductivity: 11.1, electrical_conductivity: 0.889 },
            { z: 66, symbol: "Dy", name: "鏑", category: "lanthanide", shells: [2, 8, 18, 28, 8, 2], mass: "162.5", ionization: 573, electronegativity: 1.22, density: 8.55, radius: 228, specific_heat: 0.17, thermal_conductivity: 10.7, electrical_conductivity: 1.08 },
            { z: 67, symbol: "Ho", name: "鈥", category: "lanthanide", shells: [2, 8, 18, 29, 8, 2], mass: "164.9", ionization: 581, electronegativity: 1.23, density: 8.795, radius: 226, specific_heat: 0.165, thermal_conductivity: 16.2, electrical_conductivity: 1.17 },
            { z: 68, symbol: "Er", name: "鉺", category: "lanthanide", shells: [2, 8, 18, 30, 8, 2], mass: "167.3", ionization: 589, electronegativity: 1.24, density: 9.066, radius: 226, specific_heat: 0.168, thermal_conductivity: 14.5, electrical_conductivity: 1.16 },
            { z: 69, symbol: "Tm", name: "銩", category: "lanthanide", shells: [2, 8, 18, 31, 8, 2], mass: "168.9", ionization: 597, electronegativity: 1.25, density: 9.321, radius: 222, specific_heat: 0.16, thermal_conductivity: 16.9, electrical_conductivity: 1.5 },
            { z: 70, symbol: "Yb", name: "鐿", category: "lanthanide", shells: [2, 8, 18, 32, 8, 2], mass: "173.0", ionization: 603, electronegativity: 1.1, density: 6.965, radius: 222, specific_heat: 0.155, thermal_conductivity: 38.5, electrical_conductivity: 3.51 },
            { z: 71, symbol: "Lu", name: "鎦", category: "lanthanide", shells: [2, 8, 18, 32, 9, 2], mass: "175.0", ionization: 524, electronegativity: 1.27, density: 9.84, radius: 217, specific_heat: 0.154, thermal_conductivity: 16.4, electrical_conductivity: 1.73 },
            { z: 72, symbol: "Hf", name: "鉿", category: "transition", shells: [2, 8, 18, 32, 10, 2], mass: "178.5", ionization: 659, electronegativity: 1.3, density: 13.31, radius: 208, specific_heat: 0.144, thermal_conductivity: 23, electrical_conductivity: 2.95 },
            { z: 73, symbol: "Ta", name: "鉭", category: "transition", shells: [2, 8, 18, 32, 11, 2], mass: "180.9", ionization: 761, electronegativity: 1.5, density: 16.654, radius: 200, specific_heat: 0.14, thermal_conductivity: 57.5, electrical_conductivity: 7.27 },
            { z: 74, symbol: "W", name: "鎢", category: "transition", shells: [2, 8, 18, 32, 12, 2], mass: "183.8", ionization: 770, electronegativity: 2.36, density: 19.25, radius: 193, specific_heat: 0.132, thermal_conductivity: 173, electrical_conductivity: 18.2 },
            { z: 75, symbol: "Re", name: "錸", category: "transition", shells: [2, 8, 18, 32, 13, 2], mass: "186.2", ionization: 760, electronegativity: 1.9, density: 21.02, radius: 188, specific_heat: 0.137, thermal_conductivity: 48, electrical_conductivity: 5.42 },
            { z: 76, symbol: "Os", name: "鋨", category: "transition", shells: [2, 8, 18, 32, 14, 2], mass: "190.2", ionization: 840, electronegativity: 2.2, density: 22.61, radius: 185, specific_heat: 0.13, thermal_conductivity: 87.6, electrical_conductivity: 10.9 },
            { z: 77, symbol: "Ir", name: "銥", category: "transition", shells: [2, 8, 18, 32, 15, 2], mass: "192.2", ionization: 880, electronegativity: 2.20, density: 22.56, radius: 180, specific_heat: 0.131, thermal_conductivity: 147, electrical_conductivity: 19.7 },
            { z: 78, symbol: "Pt", name: "鉑", category: "transition", shells: [2, 8, 18, 32, 17, 1], mass: "195.1", ionization: 870, electronegativity: 2.28, density: 21.46, radius: 177, specific_heat: 0.133, thermal_conductivity: 71.6, electrical_conductivity: 9.26 },
            { z: 79, symbol: "Au", name: "金", category: "transition", shells: [2, 8, 18, 32, 18, 1], mass: "197.0", ionization: 890, electronegativity: 2.54, density: 19.282, radius: 174, specific_heat: 0.129, thermal_conductivity: 318, electrical_conductivity: 45.2 },
            { z: 80, symbol: "Hg", name: "汞", category: "transition", shells: [2, 8, 18, 32, 18, 2], mass: "200.6", ionization: 1007, electronegativity: 2.00, density: 13.5336, radius: 171, specific_heat: 0.14, thermal_conductivity: 8.3, electrical_conductivity: 1.04 },
            { z: 81, symbol: "Tl", name: "鉈", category: "post-transition", shells: [2, 8, 18, 32, 18, 3], mass: "204.4", ionization: 589, electronegativity: 1.62, density: 11.85, radius: 156, specific_heat: 0.129, thermal_conductivity: 46.1, electrical_conductivity: 6.7 },
            { z: 82, symbol: "Pb", name: "鉛", category: "post-transition", shells: [2, 8, 18, 32, 18, 4], mass: "207.2", ionization: 716, electronegativity: 1.87, density: 11.342, radius: 154, specific_heat: 0.129, thermal_conductivity: 35.3, electrical_conductivity: 4.81 },
            { z: 83, symbol: "Bi", name: "鉍", category: "post-transition", shells: [2, 8, 18, 32, 18, 5], mass: "209.0", ionization: 703, electronegativity: 2.02, density: 9.807, radius: 143, specific_heat: 0.122, thermal_conductivity: 7.97, electrical_conductivity: 0.867 },
            { z: 84, symbol: "Po", name: "釙", category: "metalloid", shells: [2, 8, 18, 32, 18, 6], mass: "(209)", ionization: 812, electronegativity: 2.0, density: 9.32, radius: 135, specific_heat: null, thermal_conductivity: 20, electrical_conductivity: 0.75 },
            { z: 85, symbol: "At", name: "砈", category: "halogen", shells: [2, 8, 18, 32, 18, 7], mass: "(210)", ionization: 890, electronegativity: 2.2, density: 7, radius: 127, specific_heat: null, thermal_conductivity: 1.7, electrical_conductivity: null },
            { z: 86, symbol: "Rn", name: "氡", category: "noble", shells: [2, 8, 18, 32, 18, 8], mass: "(222)", ionization: 1037, electronegativity: 2.2, density: 0.00973, radius: 120, specific_heat: 0.094, thermal_conductivity: 0.00361, electrical_conductivity: null },
            { z: 87, symbol: "Fr", name: "鍅", category: "alkali", shells: [2, 8, 18, 32, 18, 8, 1], mass: "(223)", ionization: 380, electronegativity: 0.7, density: 1.87, radius: 348, specific_heat: null, thermal_conductivity: 15, electrical_conductivity: 1.5 },
            { z: 88, symbol: "Ra", name: "鐳", category: "alkaline", shells: [2, 8, 18, 32, 18, 8, 2], mass: "(226)", ionization: 509, electronegativity: 0.9, density: 5.5, radius: 283, specific_heat: 0.094, thermal_conductivity: 18.6, electrical_conductivity: 1 },
            { z: 89, symbol: "Ac", name: "錒", category: "actinide", shells: [2, 8, 18, 32, 18, 9, 2], mass: "(227)", ionization: 499, electronegativity: 1.1, density: 10.07, radius: 260, specific_heat: 0.12, thermal_conductivity: 12, electrical_conductivity: 0.546 },
            { z: 90, symbol: "Th", name: "釷", category: "actinide", shells: [2, 8, 18, 32, 18, 10, 2], mass: "232.0", ionization: 587, electronegativity: 1.3, density: 11.72, radius: 237, specific_heat: 0.113, thermal_conductivity: 54, electrical_conductivity: 6.53 },
            { z: 91, symbol: "Pa", name: "鏷", category: "actinide", shells: [2, 8, 18, 32, 20, 9, 2], mass: "231.0", ionization: 568, electronegativity: 1.5, density: 15.37, radius: 243, specific_heat: 0.12, thermal_conductivity: 47, electrical_conductivity: 5.26 },
            { z: 92, symbol: "U", name: "鈾", category: "actinide", shells: [2, 8, 18, 32, 21, 9, 2], mass: "238.0", ionization: 598, electronegativity: 1.38, density: 18.95, radius: 240, specific_heat: 0.116, thermal_conductivity: 27.5, electrical_conductivity: 3.6 },
            { z: 93, symbol: "Np", name: "錼", category: "actinide", shells: [2, 8, 18, 32, 22, 9, 2], mass: "(237)", ionization: 605, electronegativity: 1.36, density: 20.45, radius: 221, specific_heat: null, thermal_conductivity: 6, electrical_conductivity: 0.826 },
            { z: 94, symbol: "Pu", name: "鈽", category: "actinide", shells: [2, 8, 18, 32, 24, 8, 2], mass: "(244)", ionization: 585, electronegativity: 1.28, density: 19.84, radius: 243, specific_heat: null, thermal_conductivity: 6.74, electrical_conductivity: 0.671 },
            { z: 95, symbol: "Am", name: "鋂", category: "actinide", shells: [2, 8, 18, 32, 25, 8, 2], mass: "(243)", ionization: 578, electronegativity: 1.13, density: 13.69, radius: 244, specific_heat: null, thermal_conductivity: 10, electrical_conductivity: 0.22 },
            { z: 96, symbol: "Cm", name: "鋦", category: "actinide", shells: [2, 8, 18, 32, 25, 9, 2], mass: "(247)", ionization: 581, electronegativity: 1.28, density: 13.51, radius: 245, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 97, symbol: "Bk", name: "鉳", category: "actinide", shells: [2, 8, 18, 32, 27, 8, 2], mass: "(247)", ionization: 601, electronegativity: 1.3, density: 14.79, radius: 244, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 98, symbol: "Cf", name: "鉲", category: "actinide", shells: [2, 8, 18, 32, 28, 8, 2], mass: "(251)", ionization: 608, electronegativity: 1.3, density: 15.1, radius: 245, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 99, symbol: "Es", name: "鑀", category: "actinide", shells: [2, 8, 18, 32, 29, 8, 2], mass: "(252)", ionization: 619, electronegativity: 1.3, density: 8.84, radius: 245, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 100, symbol: "Fm", name: "鐨", category: "actinide", shells: [2, 8, 18, 32, 30, 8, 2], mass: "(257)", ionization: 627, electronegativity: 1.3, density: null, radius: 245, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 101, symbol: "Md", name: "鍆", category: "actinide", shells: [2, 8, 18, 32, 31, 8, 2], mass: "(258)", ionization: 635, electronegativity: 1.3, density: null, radius: 246, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 102, symbol: "No", name: "鍩", category: "actinide", shells: [2, 8, 18, 32, 32, 8, 2], mass: "(259)", ionization: 642, electronegativity: 1.3, density: null, radius: 246, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 103, symbol: "Lr", name: "鐒", category: "actinide", shells: [2, 8, 18, 32, 32, 8, 3], mass: "(262)", ionization: 470, electronegativity: 1.3, density: null, radius: 246, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 104, symbol: "Rf", name: "鑪", category: "transition", shells: [2, 8, 18, 32, 32, 10, 2], mass: "(267)", ionization: 580, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 105, symbol: "Db", name: "𨧀", category: "transition", shells: [2, 8, 18, 32, 32, 11, 2], mass: "(268)", ionization: null, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 106, symbol: "Sg", name: "𨭎", category: "transition", shells: [2, 8, 18, 32, 32, 12, 2], mass: "(271)", ionization: null, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 107, symbol: "Bh", name: "𨨏", category: "transition", shells: [2, 8, 18, 32, 32, 13, 2], mass: "(272)", ionization: null, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 108, symbol: "Hs", name: "𨭆", category: "transition", shells: [2, 8, 18, 32, 32, 14, 2], mass: "(270)", ionization: null, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 109, symbol: "Mt", name: "䥑", category: "unknown", shells: [2, 8, 18, 32, 32, 15, 2], mass: "(276)", ionization: null, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 110, symbol: "Ds", name: "鐽", category: "unknown", shells: [2, 8, 18, 32, 32, 16, 2], mass: "(281)", ionization: null, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 111, symbol: "Rg", name: "錀", category: "unknown", shells: [2, 8, 18, 32, 32, 17, 2], mass: "(280)", ionization: null, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 112, symbol: "Cn", name: "鎶", category: "transition", shells: [2, 8, 18, 32, 32, 18, 2], mass: "(285)", ionization: null, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 113, symbol: "Nh", name: "鉨", category: "unknown", shells: [2, 8, 18, 32, 32, 18, 3], mass: "(284)", ionization: null, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 114, symbol: "Fl", name: "鈇", category: "post-transition", shells: [2, 8, 18, 32, 32, 18, 4], mass: "(289)", ionization: null, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 115, symbol: "Mc", name: "鏌", category: "unknown", shells: [2, 8, 18, 32, 32, 18, 5], mass: "(288)", ionization: null, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 116, symbol: "Lv", name: "鉝", category: "unknown", shells: [2, 8, 18, 32, 32, 18, 6], mass: "(293)", ionization: null, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 117, symbol: "Ts", name: "鿬", category: "halogen", shells: [2, 8, 18, 32, 32, 18, 7], mass: "(294)", ionization: null, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null },
            { z: 118, symbol: "Og", name: "鿫", category: "noble", shells: [2, 8, 18, 32, 32, 18, 8], mass: "(294)", ionization: null, electronegativity: null, density: null, radius: null, specific_heat: null, thermal_conductivity: null, electrical_conductivity: null }
        ];

        // Property configurations
        const propertyConfig = {
            ionization: {
                name: '第一游離能',
                unit: 'kJ/mol',
                min: 376,
                max: 2372,
                colorStops: ['#1a1a2e', '#4a1942', '#c23a5a', '#ff6b6b', '#ffd93d']
            },
            electronegativity: {
                name: '電負度',
                unit: 'Pauling',
                min: 0.7,
                max: 3.98,
                colorStops: ['#1a1a2e', '#2d4a6f', '#4a90a4', '#7dd3c0', '#b5f5ec']
            },
            density: {
                name: '密度 (STP)',
                unit: 'g/cm³',
                min: 0,
                max: 22.61,
                colorStops: ['#1a1a2e', '#3d2066', '#7c3aed', '#a78bfa', '#e9d5ff']
            },
            radius: {
                name: '原子半徑',
                unit: 'pm',
                min: 31,
                max: 348,
                colorStops: ['#ffd93d', '#ff9f43', '#ee5a52', '#9d2449', '#1a1a2e']
            },
            specific_heat: {
                name: '比熱',
                unit: 'J/(g·K)',
                min: 0.09,
                max: 1.5,
                colorStops: ['#1a1a2e', '#2d4a6f', '#4a90a4', '#7dd3c0', '#b5f5ec']
            },
            thermal_conductivity: {
                name: '導熱率',
                unit: 'W/(m·K)',
                min: 0,
                max: 429, // Silver
                colorStops: ['#1a1a2e', '#4a1942', '#c23a5a', '#ff6b6b', '#ffd93d']
            },
            electrical_conductivity: {
                name: '導電率',
                unit: 'MS/m',
                min: 0,
                max: 63, // Silver
                colorStops: ['#1a1a2e', '#3d2066', '#7c3aed', '#a78bfa', '#e9d5ff']
            }
        };

        // Standard periodic table positions
        const standardPositions = {
            1: [0, 0], 2: [0, 17],
            3: [1, 0], 4: [1, 1], 5: [1, 12], 6: [1, 13], 7: [1, 14], 8: [1, 15], 9: [1, 16], 10: [1, 17],
            11: [2, 0], 12: [2, 1], 13: [2, 12], 14: [2, 13], 15: [2, 14], 16: [2, 15], 17: [2, 16], 18: [2, 17],
            19: [3, 0], 20: [3, 1], 21: [3, 2], 22: [3, 3], 23: [3, 4], 24: [3, 5], 25: [3, 6], 26: [3, 7], 27: [3, 8], 28: [3, 9], 29: [3, 10], 30: [3, 11], 31: [3, 12], 32: [3, 13], 33: [3, 14], 34: [3, 15], 35: [3, 16], 36: [3, 17],
            37: [4, 0], 38: [4, 1], 39: [4, 2], 40: [4, 3], 41: [4, 4], 42: [4, 5], 43: [4, 6], 44: [4, 7], 45: [4, 8], 46: [4, 9], 47: [4, 10], 48: [4, 11], 49: [4, 12], 50: [4, 13], 51: [4, 14], 52: [4, 15], 53: [4, 16], 54: [4, 17],
            55: [5, 0], 56: [5, 1], 57: [5, 2], 72: [5, 3], 73: [5, 4], 74: [5, 5], 75: [5, 6], 76: [5, 7], 77: [5, 8], 78: [5, 9], 79: [5, 10], 80: [5, 11], 81: [5, 12], 82: [5, 13], 83: [5, 14], 84: [5, 15], 85: [5, 16], 86: [5, 17],
            87: [6, 0], 88: [6, 1], 89: [6, 2], 104: [6, 3], 105: [6, 4], 106: [6, 5], 107: [6, 6], 108: [6, 7], 109: [6, 8], 110: [6, 9], 111: [6, 10], 112: [6, 11], 113: [6, 12], 114: [6, 13], 115: [6, 14], 116: [6, 15], 117: [6, 16], 118: [6, 17],
            58: [8, 3], 59: [8, 4], 60: [8, 5], 61: [8, 6], 62: [8, 7], 63: [8, 8], 64: [8, 9], 65: [8, 10], 66: [8, 11], 67: [8, 12], 68: [8, 13], 69: [8, 14], 70: [8, 15], 71: [8, 16],
            90: [9, 3], 91: [9, 4], 92: [9, 5], 93: [9, 6], 94: [9, 7], 95: [9, 8], 96: [9, 9], 97: [9, 10], 98: [9, 11], 99: [9, 12], 100: [9, 13], 101: [9, 14], 102: [9, 15], 103: [9, 16]
        };

        // Extended periodic table
        const extendedPositions = {
            1: [0, 0], 2: [0, 31],
            3: [1, 0], 4: [1, 1], 5: [1, 26], 6: [1, 27], 7: [1, 28], 8: [1, 29], 9: [1, 30], 10: [1, 31],
            11: [2, 0], 12: [2, 1], 13: [2, 26], 14: [2, 27], 15: [2, 28], 16: [2, 29], 17: [2, 30], 18: [2, 31],
            19: [3, 0], 20: [3, 1], 
            21: [3, 16], 22: [3, 17], 23: [3, 18], 24: [3, 19], 25: [3, 20], 26: [3, 21], 27: [3, 22], 28: [3, 23], 29: [3, 24], 30: [3, 25],
            31: [3, 26], 32: [3, 27], 33: [3, 28], 34: [3, 29], 35: [3, 30], 36: [3, 31],
            37: [4, 0], 38: [4, 1],
            39: [4, 16], 40: [4, 17], 41: [4, 18], 42: [4, 19], 43: [4, 20], 44: [4, 21], 45: [4, 22], 46: [4, 23], 47: [4, 24], 48: [4, 25],
            49: [4, 26], 50: [4, 27], 51: [4, 28], 52: [4, 29], 53: [4, 30], 54: [4, 31],
            55: [5, 0], 56: [5, 1],
            57: [5, 2], 58: [5, 3], 59: [5, 4], 60: [5, 5], 61: [5, 6], 62: [5, 7], 63: [5, 8], 64: [5, 9], 65: [5, 10], 66: [5, 11], 67: [5, 12], 68: [5, 13], 69: [5, 14], 70: [5, 15],
            71: [5, 16], 72: [5, 17], 73: [5, 18], 74: [5, 19], 75: [5, 20], 76: [5, 21], 77: [5, 22], 78: [5, 23], 79: [5, 24], 80: [5, 25],
            81: [5, 26], 82: [5, 27], 83: [5, 28], 84: [5, 29], 85: [5, 30], 86: [5, 31],
            87: [6, 0], 88: [6, 1],
            89: [6, 2], 90: [6, 3], 91: [6, 4], 92: [6, 5], 93: [6, 6], 94: [6, 7], 95: [6, 8], 96: [6, 9], 97: [6, 10], 98: [6, 11], 99: [6, 12], 100: [6, 13], 101: [6, 14], 102: [6, 15],
            103: [6, 16], 104: [6, 17], 105: [6, 18], 106: [6, 19], 107: [6, 20], 108: [6, 21], 109: [6, 22], 110: [6, 23], 111: [6, 24], 112: [6, 25],
            113: [6, 26], 114: [6, 27], 115: [6, 28], 116: [6, 29], 117: [6, 30], 118: [6, 31]
        };

        const table = document.getElementById('periodicTable');
        const tableContainer = document.getElementById('tableContainer');
        const tooltip = document.getElementById('tooltip');
        const viewInfo = document.getElementById('viewInfo');
        const zoomDisplay = document.getElementById('zoomDisplay');
        const speedSlider = document.getElementById('speedSlider');
        const speedDisplay = document.getElementById('speedDisplay');
        const colorScale = document.getElementById('colorScale');
        const scaleTitle = document.getElementById('scaleTitle');
        const propertySelect = document.getElementById('propertySelect');

        // Global Variables
        let currentView = 'standard';
        let currentProperty = 'none';
        let zoomLevel = 1;
        let animationSpeed = 1;
        let translateX = 0;
        let translateY = 0;
        let isDragging = false;
        let hasDragged = false;
        let startX = 0;
        let startY = 0;
        let startTranslateX = 0;
        let startTranslateY = 0;
        let initialPinchDistance = 0;
        let initialZoomLevel = 1;
        let isPinching = false;

        const minZoom = 0.1;
        const maxZoom = 5;
        const zoomStep = 0.2;
        const cellWidth = 52;
        const cellHeight = 60;
        const gap = 4;
        const topPadding = 80;
        const speedValues = [0, 0.5, 1, 2, 5, 10];

        const viewDescriptions = {
            linear: '目前視圖：按原子序排列',
            standard: '目前視圖：標準週期表',
            extended: '目前視圖：寬版週期表'
        };

        function interpolateColor(value, min, max, colorStops) {
            if (value === null || value === undefined) return null;
            const ratio = Math.max(0, Math.min(1, (value - min) / (max - min)));
            const segment = ratio * (colorStops.length - 1);
            const index = Math.floor(segment);
            const t = segment - index;
            if (index >= colorStops.length - 1) return colorStops[colorStops.length - 1];
            const c1 = hexToRgb(colorStops[index]);
            const c2 = hexToRgb(colorStops[index + 1]);
            const r = Math.round(c1.r + (c2.r - c1.r) * t);
            const g = Math.round(c1.g + (c2.g - c1.g) * t);
            const b = Math.round(c1.b + (c2.b - c1.b) * t);
            return `rgb(${r}, ${g}, ${b})`;
        }

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : { r: 0, g: 0, b: 0 };
        }

        function isLightColor(color) {
            if (!color) return false;
            let r, g, b;
            if (color.startsWith('#')) {
                const rgb = hexToRgb(color);
                r = rgb.r; g = rgb.g; b = rgb.b;
            } else {
                const match = color.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);
                if (!match) return false;
                r = parseInt(match[1]);
                g = parseInt(match[2]);
                b = parseInt(match[3]);
            }
            const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
            return luminance > 0.6;
        }

        function createElements() {
            elements.forEach((el) => {
                const div = document.createElement('div');
                div.className = `element ${el.category}`;
                div.dataset.z = el.z;
                div.innerHTML = `
                    <span class="number">${el.z}</span>
                    <span class="symbol">${el.symbol}</span>
                    <span class="name">${el.name}</span>
                    <span class="mass">${el.mass}</span>
                    <div class="property-bar"></div>
                    <span class="property-value"></span>
                `;
                div.addEventListener('click', (e) => {
                    if (hasDragged) return;
                    e.stopPropagation();
                    showTooltip(e, el);
                });
                table.appendChild(div);
            });
        }

        function updatePropertyDisplay(property) {
            currentProperty = property;
            const elementsDiv = document.querySelectorAll('.element');
            const config = propertyConfig[property];

            if (property === 'none') {
                colorScale.classList.remove('visible');
                elementsDiv.forEach((el, index) => {
                    const category = elements[index].category;
                    const catColor = categoryColors[category];
                    
                    el.classList.remove('property-mode', 'light-bg', 'radius-mode', 'bar-mode', 'density-mode');
                    el.style.backgroundColor = catColor;
                    el.classList.toggle('light-bg', isLightColor(catColor));
                    
                    el.style.setProperty('--el-scale', 1);
                    el.querySelector('.property-bar').style.height = '0';
                    el.querySelector('.property-value').textContent = '';
                });
                return;
            }

            colorScale.classList.add('visible');
            scaleTitle.textContent = config.name;
            const scaleBar = document.querySelector('.scale-bar');
            scaleBar.style.background = `linear-gradient(to right, ${config.colorStops.join(', ')})`;
            const maxVal = config.max; 

            elementsDiv.forEach((el, index) => {
                const elementData = elements[index];
                const value = elementData[property];
                const color = interpolateColor(value, config.min, config.max, config.colorStops);

                el.classList.add('property-mode');
                el.classList.remove('radius-mode', 'bar-mode', 'density-mode');
                el.style.setProperty('--el-scale', 1);
                el.querySelector('.property-bar').style.height = '0'; 
                el.style.backgroundColor = ''; 
                
                if (property === 'radius') {
                    el.classList.add('radius-mode');
                    let scale = 1;
                    if (value !== null) {
                        scale = 0.3 + (value / maxVal) * 0.9;
                    } else {
                        scale = 0.3; 
                    }
                    el.style.setProperty('--el-scale', scale);
                    if (color) {
                        el.style.backgroundColor = color;
                        el.classList.toggle('light-bg', isLightColor(color));
                    } else {
                        el.style.backgroundColor = 'var(--bg-tertiary)';
                        el.classList.remove('light-bg');
                    }
                } 
                else if (property === 'density' || property === 'specific_heat') {
                    el.classList.add('density-mode');
                    if (color) {
                        el.style.backgroundColor = color;
                        el.classList.toggle('light-bg', isLightColor(color));
                    } else {
                        el.style.backgroundColor = 'var(--bg-tertiary)';
                        el.classList.remove('light-bg');
                    }
                }
                else {
                    el.classList.add('bar-mode');
                    let barHeight = 0;
                    if (value !== null) {
                        barHeight = (value / config.max) * 100;
                        if(barHeight > 100) barHeight = 100;
                    }
                    const barEl = el.querySelector('.property-bar');
                    barEl.style.height = `${barHeight}%`;
                    if (color) {
                       el.style.setProperty('--prop-color', color);
                    }
                    el.style.backgroundColor = '';
                    el.classList.remove('light-bg');
                }

                let displayValue = '';
                if (value !== null) {
                    if ((property === 'density' || property === 'specific_heat' || property === 'thermal_conductivity') && value < 0.01) {
                        displayValue = value.toExponential(1);
                    } else if (property === 'density' || property === 'electronegativity' || property === 'specific_heat' || property === 'thermal_conductivity' || property === 'electrical_conductivity') {
                        // Adaptive precision based on value size
                        if (value >= 100) displayValue = Math.round(value);
                        else if (value >= 10) displayValue = value.toFixed(1);
                        else displayValue = value.toFixed(2);
                    } else {
                        displayValue = Math.round(value);
                    }
                } else {
                    displayValue = 'N/A';
                }
                el.querySelector('.property-value').textContent = displayValue;
            });
        }

        function updateAnimationSpeed(sliderIndex) {
            const speed = speedValues[sliderIndex];
            animationSpeed = speed;
            document.documentElement.style.setProperty('--animation-duration', `${speed}s`);
            speedDisplay.textContent = `${speed}s`;
        }

        function applyTransform() {
            table.style.transform = `translate(${translateX}px, ${translateY}px) scale(${zoomLevel})`;
        }

        function centerTable() {
            let maxCol = 0;
            let maxRow = 0;
            elements.forEach(el => {
                const z = parseInt(el.z);
                let pos;
                if (currentView === 'linear') pos = { row: 0, col: z - 1 };
                else if (currentView === 'standard') pos = { row: standardPositions[z][0], col: standardPositions[z][1] };
                else if (currentView === 'extended') pos = { row: extendedPositions[z][0], col: extendedPositions[z][1] };
                maxCol = Math.max(maxCol, pos.col);
                maxRow = Math.max(maxRow, pos.row);
            });

            const contentWidth = (maxCol + 1) * (cellWidth + gap);
            const contentHeight = (maxRow + 1) * (cellHeight + gap) + topPadding;
            const viewportWidth = tableContainer.clientWidth;
            const viewportHeight = tableContainer.clientHeight;

            if (viewportWidth < 600) {
                zoomLevel = Math.max(minZoom, Math.min(1, viewportWidth / contentWidth * 1.5));
                zoomDisplay.textContent = `${Math.round(zoomLevel * 100)}%`;
            }

            translateX = (viewportWidth - contentWidth * zoomLevel) / 2;
            translateY = (viewportHeight - contentHeight * zoomLevel) / 2;
            
            if (translateY < 0 && contentHeight * zoomLevel < viewportHeight) {
                 translateY = 50; 
            } else if (viewportHeight < 600) {
                translateY = Math.max(translateY, 20);
            }
            applyTransform();
        }

        function zoomAtPoint(factor, startX, startY) {
            const oldZoom = zoomLevel;
            const newZoom = Math.max(minZoom, Math.min(maxZoom, zoomLevel * factor));
            if (newZoom === oldZoom) return;
            const rect = tableContainer.getBoundingClientRect();
            const mouseX = startX - rect.left;
            const mouseY = startY - rect.top;
            const localX = (mouseX - translateX) / oldZoom;
            const localY = (mouseY - translateY) / oldZoom;
            zoomLevel = newZoom;
            zoomDisplay.textContent = `${Math.round(zoomLevel * 100)}%`;
            translateX = mouseX - localX * newZoom;
            translateY = mouseY - localY * newZoom;
            applyTransform();
        }

        function updateLayout(view) {
            const elementsDiv = document.querySelectorAll('.element');
            let maxCol = 0;
            let maxRow = 0;
            elementsDiv.forEach(el => {
                const z = parseInt(el.dataset.z);
                let pos;
                if (view === 'linear') {
                    pos = { row: 0, col: z - 1 };
                } else if (view === 'standard') {
                    pos = { row: standardPositions[z][0], col: standardPositions[z][1] };
                } else if (view === 'extended') {
                    pos = { row: extendedPositions[z][0], col: extendedPositions[z][1] };
                }
                const x = pos.col * (cellWidth + gap);
                const y = pos.row * (cellHeight + gap) + topPadding;
                el.style.left = `${x}px`;
                el.style.top = `${y}px`;
                maxCol = Math.max(maxCol, pos.col);
                maxRow = Math.max(maxRow, pos.row);
            });
            const contentWidth = (maxCol + 1) * (cellWidth + gap);
            const contentHeight = (maxRow + 1) * (cellHeight + gap) + topPadding;
            table.style.width = `${contentWidth}px`;
            table.style.height = `${contentHeight}px`;
            viewInfo.textContent = viewDescriptions[view];
            setTimeout(centerTable, 50);
        }

        function generateAtomSVG(element) {
            const shells = element.shells || [];
            const size = 120;
            const center = size / 2;
            const nucleusRadius = 8;
            const maxRadius = size / 2 - 5;
            
            // Calculate ring spacing based on number of shells
            const ringCount = shells.length;
            const ringSpacing = (maxRadius - nucleusRadius) / (ringCount + 0.5); // Add buffer
            
            let svgContent = `
                <circle cx="${center}" cy="${center}" r="${nucleusRadius}" fill="var(--accent)" fill-opacity="0.3" stroke="var(--accent)" stroke-width="1" />
                <text x="${center}" y="${center}" dy="0.35em" text-anchor="middle" font-size="8" fill="var(--text-primary)" font-weight="bold">${element.symbol}</text>
            `;
            
            // Generate rings and electrons
            shells.forEach((electronCount, index) => {
                const ringRadius = nucleusRadius + (index + 1) * ringSpacing;
                
                // Ring
                svgContent += `<circle cx="${center}" cy="${center}" r="${ringRadius}" fill="none" stroke="var(--text-secondary)" stroke-width="0.5" stroke-opacity="0.5" />`;
                
                // Electrons
                for (let i = 0; i < electronCount; i++) {
                    const angle = (i / electronCount) * 2 * Math.PI - (Math.PI / 2); // Start from top
                    const ex = center + ringRadius * Math.cos(angle);
                    const ey = center + ringRadius * Math.sin(angle);
                    
                    svgContent += `<circle cx="${ex}" cy="${ey}" r="2" fill="#4dabf7" stroke="var(--bg-secondary)" stroke-width="0.5" />`;
                }
            });
            
            return `<svg viewBox="0 0 ${size} ${size}" width="${size}" height="${size}" class="atom-svg">${svgContent}</svg>`;
        }

        function showTooltip(e, el) {
            const categoryNames = {
                'alkali': '鹼金屬', 'alkaline': '鹼土金屬', 'transition': '過渡金屬',
                'post-transition': '後過渡金屬', 'metalloid': '類金屬', 'nonmetal': '非金屬',
                'halogen': '鹵素', 'noble': '稀有氣體', 'lanthanide': '鑭系元素',
                'actinide': '錒系元素', 'unknown': '未知特性'
            };

            let propVal = '';
            let propUnit = '';
            if (currentProperty !== 'none') {
                const config = propertyConfig[currentProperty];
                const val = el[currentProperty];
                if (val !== null) {
                    if ((currentProperty === 'density' || currentProperty === 'specific_heat' || currentProperty === 'thermal_conductivity') && val < 0.01) propVal = val.toExponential(2);
                    else if (typeof val === 'number') {
                         if (val >= 100) propVal = Math.round(val);
                         else if (val >= 10) propVal = val.toFixed(1);
                         else propVal = val.toFixed(2);
                    }
                    propUnit = config.unit;
                } else {
                    propVal = '無資料';
                }
            }

            // Generate Atom SVG
            const atomSVG = generateAtomSVG(el);
            
            // Build props grid HTML
            const propsGrid = `
                <div class="props-grid">
                    ${currentProperty !== 'none' ? `
                    <div class="prop-focus">
                        <span>${propertyConfig[currentProperty].name}</span>
                        <span class="prop-val">${propVal} ${propUnit}</span>
                    </div>` : ''}
                    <div class="prop-item"><span class="prop-label">原子量</span><span class="prop-val">${el.mass}</span></div>
                    <div class="prop-item"><span class="prop-label">游離能</span><span class="prop-val">${el.ionization || '-'}</span></div>
                    <div class="prop-item"><span class="prop-label">電負度</span><span class="prop-val">${el.electronegativity || '-'}</span></div>
                    <div class="prop-item"><span class="prop-label">密度</span><span class="prop-val">${el.density || '-'}</span></div>
                    <div class="prop-item"><span class="prop-label">半徑</span><span class="prop-val">${el.radius || '-'}</span></div>
                    <div class="prop-item"><span class="prop-label">比熱</span><span class="prop-val">${el.specific_heat || '-'}</span></div>
                    <div class="prop-item"><span class="prop-label">導熱率</span><span class="prop-val">${el.thermal_conductivity || '-'}</span></div>
                    <div class="prop-item"><span class="prop-label">導電率</span><span class="prop-val">${el.electrical_conductivity || '-'}</span></div>
                </div>
            `;

            tooltip.innerHTML = `
                <div class="atom-container">
                    ${atomSVG}
                </div>
                <div class="tooltip-header">
                    <h3>${el.symbol}</h3>
                    <span class="atomic-number">${el.z} - ${el.name}</span>
                    <span class="category-label">${categoryNames[el.category]}</span>
                </div>
                ${propsGrid}
            `;
            
            tooltip.classList.add('visible');
            moveTooltip(e);
        }

        function moveTooltip(e) {
            if (window.innerWidth <= 768) return;
            let x = e.clientX + 15;
            let y = e.clientY + 15;
            const wasVisible = tooltip.classList.contains('visible');
            if (!wasVisible) {
                tooltip.style.visibility = 'hidden';
                tooltip.style.display = 'block';
            }
            const rect = tooltip.getBoundingClientRect();
            if (!wasVisible) {
                tooltip.style.visibility = '';
                tooltip.style.display = '';
            }
            if (x + rect.width > window.innerWidth) x = e.clientX - rect.width - 15;
            if (y + rect.height > window.innerHeight) y = e.clientY - rect.height - 15;
            tooltip.style.left = `${x}px`;
            tooltip.style.top = `${y}px`;
        }

        function hideTooltip() {
            tooltip.classList.remove('visible');
        }

        tableContainer.addEventListener('mousedown', (e) => {
            if(e.button !== 0) return;
            isDragging = true;
            hasDragged = false;
            tableContainer.classList.add('grabbing');
            startX = e.clientX;
            startY = e.clientY;
            startTranslateX = translateX;
            startTranslateY = translateY;
            hideTooltip();
        });

        window.addEventListener('mouseup', () => {
            if (isDragging) {
                isDragging = false;
                tableContainer.classList.remove('grabbing');
            }
        });

        window.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            e.preventDefault();
            const dx = e.clientX - startX;
            const dy = e.clientY - startY;
            if (Math.abs(dx) > 5 || Math.abs(dy) > 5) {
                hasDragged = true;
            }
            translateX = startTranslateX + dx;
            translateY = startTranslateY + dy;
            applyTransform();
        });

        function getDistance(touches) {
            const dx = touches[0].clientX - touches[1].clientX;
            const dy = touches[0].clientY - touches[1].clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }

        function getMidpoint(touches) {
            return {
                x: (touches[0].clientX + touches[1].clientX) / 2,
                y: (touches[0].clientY + touches[1].clientY) / 2
            };
        }

        tableContainer.addEventListener('touchstart', (e) => {
            if (e.touches.length === 1) {
                isDragging = true;
                hasDragged = false;
                isPinching = false;
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
                startTranslateX = translateX;
                startTranslateY = translateY;
                hideTooltip();
            } else if (e.touches.length === 2) {
                isDragging = false;
                isPinching = true;
                initialPinchDistance = getDistance(e.touches);
                initialZoomLevel = zoomLevel;
                hideTooltip();
            }
        }, { passive: false });

        tableContainer.addEventListener('touchmove', (e) => {
            e.preventDefault();
            if (isDragging && e.touches.length === 1) {
                const dx = e.touches[0].clientX - startX;
                const dy = e.touches[0].clientY - startY;
                if (Math.abs(dx) > 5 || Math.abs(dy) > 5) hasDragged = true;
                translateX = startTranslateX + dx;
                translateY = startTranslateY + dy;
                applyTransform();
            } 
            else if (isPinching && e.touches.length === 2) {
                const currentDistance = getDistance(e.touches);
                const mid = getMidpoint(e.touches);
                const scale = currentDistance / initialPinchDistance;
                const newZoom = Math.max(minZoom, Math.min(maxZoom, initialZoomLevel * scale));
                const factor = newZoom / zoomLevel;
                zoomAtPoint(factor, mid.x, mid.y);
            }
        }, { passive: false });

        tableContainer.addEventListener('touchend', (e) => {
            if (e.touches.length === 0) {
                isDragging = false;
                isPinching = false;
            }
        });

        document.querySelectorAll('.view-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentView = btn.dataset.view;
                updateLayout(currentView);
            });
        });

        propertySelect.addEventListener('change', (e) => {
            updatePropertyDisplay(e.target.value);
        });

        document.getElementById('zoomIn').addEventListener('click', () => {
            const rect = tableContainer.getBoundingClientRect();
            zoomAtPoint(1.2, rect.width/2 + rect.left, rect.height/2 + rect.top);
        });
        
        document.getElementById('zoomOut').addEventListener('click', () => {
            const rect = tableContainer.getBoundingClientRect();
            zoomAtPoint(0.8, rect.width/2 + rect.left, rect.height/2 + rect.top);
        });
        
        document.getElementById('zoomReset').addEventListener('click', () => {
            zoomLevel = 1;
            zoomDisplay.textContent = '100%';
            centerTable();
        });

        speedSlider.addEventListener('input', (e) => updateAnimationSpeed(parseInt(e.target.value)));

        tableContainer.addEventListener('wheel', (e) => {
            e.preventDefault();
            const factor = e.deltaY > 0 ? 0.9 : 1.1;
            zoomAtPoint(factor, e.clientX, e.clientY);
        }, { passive: false });

        document.addEventListener('click', (e) => {
            if (!e.target.closest('.element') && !e.target.closest('.tooltip')) {
                hideTooltip();
            }
        });

        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }

        createElements();
        updateAnimationSpeed(2); 
        updateLayout('standard');
        updatePropertyDisplay('none');
        
        window.addEventListener('resize', centerTable);
    </script>
</body>
</html>
